library(caret)

#remove Na values and change to 0
 df2=filter(df1, !is.na(df1$anzrodriskofdeath))
 
#create index for train/test
 trainindex=createDataPartition(df1$ralos, p=.8, list=FALSE, times = 1)
train = df1[trainindex,]
test = df1[-trainindex,]

#create resampling techniqe
fitControl = trainControl(method = "repeatedcv",
                           number = 10,
                               repeats = 10)
                               
#specify gbm parameters
gbmGrid =  expand.grid(interaction.depth= 3, 
                        n.trees = 100, 
                        shrinkage = 0.1,
                        n.minobsinnode = 10)

model_gbm = train(died_hosp ~ anzrodriskofdeath, data=train, 
                  method="gbm", 
                  trControl = fitControl, 
                  tuneGrid = gbmGrid, 
                  verbose = FALSE
                  )
model_gbm
